<link rel="stylesheet" href="../resources/styles/elf-template.css">

<h1 id="row-dragging">Row Dragging</h1>
<p>The Row Dragging Extension allows the user to drag and reorder selected rows.</p>
<code-sandbox hash="5fcceb71"><pre><code class="language-css">efx-grid {
    height: 308px;
}
html hr {
    margin: 5px;
}
</code></pre>
<pre><code class="language-html">&lt;button id=&quot;get_btn&quot;&gt;Show Data&lt;/button&gt;
&lt;hr&gt;
&lt;efx-grid id=&quot;grid&quot;&gt;&lt;/efx-grid&gt;
</code></pre>
<pre><code class="language-javascript">await (await import(&quot;./theme-loader.js&quot;)).default; // This line is only required for demo purpose. It is not relevant for using EFX Grid in your application.

/* ---------------------------------- Note ----------------------------------
  DataGenerator, Formatters and extensions are exposed to global scope
  in the bundle file to make it easier to create live examples.
  Importing formatters and extensions is still required in your application. 
  Please see the document for further information.
---------------------------------------------------------------------------*/
var fields = [&quot;id&quot;, &quot;companyName&quot;, &quot;market&quot;, &quot;CF_LAST&quot;, &quot;CF_NETCHNG&quot;, &quot;industry&quot;];
var records = DataGenerator.generateRecords(fields, { numRows: 10 });
var configObj = {
    columns: [
        { field: fields[0], width: 30, alignment: &quot;center&quot; },
        { title: &quot;Company&quot;, field: fields[1] },
        { title: &quot;Market&quot;, field: fields[2], width: 120 },
        { title: &quot;Last&quot;, field: fields[3], width: 100 },
        { title: &quot;Net. Chng&quot;, field: fields[4], width: 100 },
        { title: &quot;Industry&quot;, field: fields[5] }
    ],
    staticDataRows: records,
    extensions: [
        new RowDragging()
    ]
};

var grid = document.getElementById(&quot;grid&quot;);
grid.config = configObj;

document.getElementById(&quot;get_btn&quot;).addEventListener(&quot;click&quot;, function(e) {
    var rows = grid.api.getMultipleRowData(); // Get all row definitions
    var colData = rows.map(function getIdAndCompanyName(rowData) {
        return rowData[&quot;id&quot;] + &quot;: &quot; + rowData[&quot;companyName&quot;];
    });
    alert(colData.join(&quot;\n&quot;));
});
</code></pre>
</code-sandbox><h2 id="installation-and-how-to-import-to-a-project">Installation and how to import to a project</h2>
<p>Installation examples and details of how to import the extension to a project are available on the <a href="./extensions/readme">Overview</a> page.</p>
<h2 id="custom-dragbox">Custom dragbox</h2>
<p>This allows users to customize the <code>dragBox</code> by providing a <code>dragBoxRenderer</code> option. It is not enabled initially.</p>
<pre><code class="language-js">var gridConfig = {
    ...
    columns: [
        { title: &quot;Column 1&quot;, field: &quot;col1&quot; },
        { title: &quot;Column 2&quot;, field: &quot;col2&quot; },
        { title: &quot;Column 3&quot;, field: &quot;col3&quot; },
        { title: &quot;Column 4&quot;, field: &quot;col4&quot; },
    ],
    rowDragging: {
        dragBoxRenderer: function(e) {
            e.dragBox.textContent = e.dataRow.col1;
        }
    }
    ...
}
</code></pre>
<h2 id="drag-and-drop-content-outside-grids-area">Drag and drop content outside grid&#39;s area</h2>
<p>The Row Dragging Extension can be used together with the <code>RowSelectionPlugin</code> to allow users to drag a selected row and drop it to a target outside of a Grid. Then, add <code>dragEnd</code> handler to perform content copying of the selected rows as illustrated below:</p>
<code-sandbox hash="3263bc25"><pre><code class="language-css">efx-grid {
    height: 308px;
}

#drop_target {
    width: 100%;
    height: 100px;
}
</code></pre>
<pre><code class="language-html">&lt;efx-grid id=&quot;grid&quot;&gt;&lt;/efx-grid&gt;
&lt;textarea id=&quot;drop_target&quot; placeholder=&quot;Drop Content Here&quot;&gt;&lt;/textarea&gt;
</code></pre>
<pre><code class="language-javascript">await (await import(&quot;./theme-loader.js&quot;)).default; // This line is only required for demo purpose. It is not relevant for using EFX Grid in your application.

/* ---------------------------------- Note ----------------------------------
  DataGenerator, Formatters and extensions are exposed to global scope
  in the bundle file to make it easier to create live examples.
  Importing formatters and extensions is still required in your application. 
  Please see the document for further information.
---------------------------------------------------------------------------*/
function onDragEnd(e) {
    var dropTargetEl = document.getElementById(&quot;drop_target&quot;);
    if (e.dropTarget !== dropTargetEl) {
        return;
    }
    var rowSelectionExt = e.srcGrid.getPlugin(&quot;RowSelectionPlugin&quot;);
    var rowIndices = rowSelectionExt.getSelectedRows();
    
    var text = &quot;No Selected Row&quot;;
    if (rowIndices) {
        var rows = grid.api.getMultipleRowData(rowIndices);
        text = JSON.stringify(rows, function replacer(key, val) {
            if(key === &quot;ROW_DEF&quot;) { // Exclude Row definition reference
                return;
            }
            return val;
        }, 2)
    }
    dropTargetEl.value = text;
}

var fields = [&quot;id&quot;, &quot;companyName&quot;, &quot;market&quot;, &quot;CF_LAST&quot;, &quot;CF_NETCHNG&quot;, &quot;industry&quot;];
var records = DataGenerator.generateRecords(fields, { numRows: 10 });
var configObj = {
    columns: [
        { field: fields[0], width: 30, alignment: &quot;center&quot; },
        { title: &quot;Company&quot;, field: fields[1] },
        { title: &quot;Market&quot;, field: fields[2], width: 120 },
        { title: &quot;Last&quot;, field: fields[3], width: 100 },
        { title: &quot;Net. Chng&quot;, field: fields[4], width: 100 },
        { title: &quot;Industry&quot;, field: fields[5] }
    ],
    staticDataRows: records,
    rowDragging: {
        autoScroll: false,
        dragEnd: onDragEnd
    },
    extensions: [
        new RowSelection(), new RowDragging()
    ]
};

var grid = document.getElementById(&quot;grid&quot;);
grid.config = configObj;
</code></pre>
</code-sandbox><h2 id="migrating-from-built-in-column-grouping">Migrating from built-in column grouping</h2>
<p>Due to the built-in libraries being migrated out from the <code>Core Grid</code> to extensions, built-in column grouping will be deprecated and will no longer be maintained.</p>
<p>The differences between the legacy (built-in) version of Row Dragging and the new extension can be seen in the examples below</p>
<blockquote>
<p>Note: The Row Dragging Extension is backward compatible with the old built-in (with some breaking changes). Therefore, the new implementation is recommended.</p>
</blockquote>
<h3 id="built-in">Built-in</h3>
<pre><code class="language-js">var gridConfig = {
    ...
    rowReorder: {
        dragBoxRenderer: function (dragEvent, dragBox, dataRows) {
            dragBox.setContent(&quot;test&quot;);
        }
    },
    ...
}
</code></pre>
<h3 id="new-extension">New extension</h3>
<pre><code class="language-js">var gridConfig = {
    ...
    rowDragging: {
        dragBoxRenderer: function (e) {
            // e.dragBox
            // e.dataRows
            e.dragBox.textContent = &quot;test&quot;;
        }
    },
    ...
}
</code></pre>
<p>For the new implementation, you need to change to the <code>rowDragging</code> option. And the <code>dragBoxRenderer</code> receives an <code>event</code> only as an argument.</p>
<div></div>

<h2 style="margin-bottom:5px" id="api-refs">API Reference</h2>
<div id="elf-api-container"><div id="main-template" class="elf-template">    <section><article>                                                                        <h3 class="subsection-title" id="type_definitions">Type Definitions</h3>                        <div class="item">            <div class="item-type">typedef</div>    <h4 class="name" id="~Options">Options</h4><div class="description">    Available options describing `rowDragging` object specified in grid's option</div>    <h5>Type:</h5>    <span class="param-type">Object</span>    <h5>Properties:</h5>    <div class="props"><table>    <thead>    <tr>                <th>Name</th>                <th>Type</th>                <th>Attributes</th>                        <th>Default</th>                <th class="last">Description</th>    </tr>    </thead>    <tbody>            <tr>                            <td class="name"><code>dragBox</code></td>                        <td class="type">                            <span class="param-type">boolean</span>                        </td>                            <td class="attributes">                                    &lt;optional&gt;<br>                                                </td>                                        <td class="default">                                    false                                </td>                        <td class="description last">If enabled, information box will be shown during the drag</td>        </tr>            <tr>                            <td class="name"><code>disabled</code></td>                        <td class="type">                            <span class="param-type">boolean</span>                        </td>                            <td class="attributes">                                    &lt;optional&gt;<br>                                                </td>                                        <td class="default">                                    false                                </td>                        <td class="description last">A flag to turn off UIs, while events will still be dispatched. If enabled, guileline and drag box will be hidden. autoScroll will also be turned off.</td>        </tr>            <tr>                            <td class="name"><code>mouseInput</code></td>                        <td class="type">                            <span class="param-type">boolean</span>                        </td>                            <td class="attributes">                                    &lt;optional&gt;<br>                                                </td>                                        <td class="default">                                    true                                </td>                        <td class="description last">If disabled, mousemove/mousedown will not trigger the drag operation.</td>        </tr>            <tr>                            <td class="name"><code>dataTransfer</code></td>                        <td class="type">                            <span class="param-type">boolean</span>                        </td>                            <td class="attributes">                                    &lt;optional&gt;<br>                                                </td>                                        <td class="default">                                    true                                </td>                        <td class="description last">If disabled, internal row data will not be moved at the end of the drag operation.</td>        </tr>            <tr>                            <td class="name"><code>autoScroll</code></td>                        <td class="type">                            <span class="param-type">boolean</span>                        </td>                            <td class="attributes">                                    &lt;optional&gt;<br>                                                </td>                                        <td class="default">                                    true                                </td>                        <td class="description last">If disabled, grid will not be verticallly scrolled when mouse is hovering around the edges of the grid.</td>        </tr>            <tr>                            <td class="name"><code>dragBoxRenderer</code></td>                        <td class="type">                            <span class="param-type">function</span>                        </td>                            <td class="attributes">                                    &lt;optional&gt;<br>                                                </td>                                        <td class="default">                                </td>                        <td class="description last">Allow user to customize dragBox</td>        </tr>            <tr>                            <td class="name"><code>dragStart</code></td>                        <td class="type">                            <span class="param-type">function</span>                        </td>                            <td class="attributes">                                    &lt;optional&gt;<br>                                                </td>                                        <td class="default">                                    null                                </td>                        <td class="description last">Function handler for dragStart event</td>        </tr>            <tr>                            <td class="name"><code>drag</code></td>                        <td class="type">                            <span class="param-type">function</span>                        </td>                            <td class="attributes">                                    &lt;optional&gt;<br>                                                </td>                                        <td class="default">                                    null                                </td>                        <td class="description last">Function handler for drag event</td>        </tr>            <tr>                            <td class="name"><code>dragEnd</code></td>                        <td class="type">                            <span class="param-type">function</span>                        </td>                            <td class="attributes">                                    &lt;optional&gt;<br>                                                </td>                                        <td class="default">                                    null                                </td>                        <td class="description last">Function handler for dragEnd event</td>        </tr>            <tr>                            <td class="name"><code>dataMoved</code></td>                        <td class="type">                            <span class="param-type">function</span>                        </td>                            <td class="attributes">                                    &lt;optional&gt;<br>                                                </td>                                        <td class="default">                                    null                                </td>                        <td class="description last">Function handler for dataMoved event</td>        </tr>        </tbody></table></div><div class="details">                                                            </div></div>                            <h3 class="subsection-title" id="methods">Methods</h3>                    <div class="item">                                <div class="item-type">function</div>                        <h4 class="name" id="cancelDrag"><span class="type-signature"></span>cancelDrag<span class="signature">()</span><span class="type-signature"></span></h4>                                            <div class="details">                                                            </div>                                    </div>                    <div class="item">                                <div class="item-type">function</div>                        <h4 class="name" id="config"><span class="type-signature"></span>config<span class="signature">(options<span class="signature-attributes">opt</span>)</span><span class="type-signature"></span></h4>                                                <h5>Parameters:</h5>        <div class="params">        <div class="param">                            <div class="name">options</div>                        <div class="type">                            <span class="param-type">Object</span>                        </div>                            <div class="attributes">                                    &lt;optional&gt;                                                                </div>                                                    <div class="description">                    Grid model object                </div>                    </div>            </div>        <div class="details">                                                            </div>                                    </div>                    <div class="item">                                <div class="item-type">function</div>                        <h4 class="name" id="disable"><span class="type-signature"></span>disable<span class="signature">(disabled<span class="signature-attributes">opt</span>)</span><span class="type-signature"></span></h4>                            <div class="description">        Disable drag and drop functionality. Unlike disableUIs method, no events will be triggered or dispatched by user actions.This method is useful for temporary turnning off drag and drop functionalities.    </div>                            <h5>Parameters:</h5>        <div class="params">        <div class="param">                            <div class="name">disabled</div>                        <div class="type">                            <span class="param-type">boolean</span>                        </div>                            <div class="attributes">                                    &lt;optional&gt;                                                                </div>                                            </div>            </div>        <div class="details">                                                            <dt class="tag-see">See:</dt>    <dd class="tag-see">        <ul>            <li><a href="/extensions/tr-grid-row-dragging#disable">RowDraggingPlugin#disable</a></li>        </ul>    </dd>        </div>                                    </div>                    <div class="item">                                <div class="item-type">function</div>                        <h4 class="name" id="disableUIs"><span class="type-signature"></span>disableUIs<span class="signature">(disabled<span class="signature-attributes">opt</span>)</span><span class="type-signature"></span></h4>                            <div class="description">        Disable UIs, while events will still be triggered by user actions. This method modify `disabled` property on the configuration object.This method is useful for customizing UIs during the drag operations.    </div>                            <h5>Parameters:</h5>        <div class="params">        <div class="param">                            <div class="name">disabled</div>                        <div class="type">                            <span class="param-type">boolean</span>                        </div>                            <div class="attributes">                                    &lt;optional&gt;                                                                </div>                                            </div>            </div>        <div class="details">                                                            <dt class="tag-see">See:</dt>    <dd class="tag-see">        <ul>            <li><a href="/extensions/tr-grid-row-dragging#disable">RowDraggingPlugin#disable</a></li>        </ul>    </dd>        </div>                                    </div>                    <div class="item">                                <div class="item-type">function</div>                        <h4 class="name" id="getConfigObject"><span class="type-signature"></span>getConfigObject<span class="signature">(out_obj<span class="signature-attributes">opt</span>)</span><span class="type-signature"> → {Object}</span></h4>                            <div class="description">        Get a current state of grid and extension config    </div>                            <h5>Parameters:</h5>        <div class="params">        <div class="param">                            <div class="name">out_obj</div>                        <div class="type">                            <span class="param-type">Object</span>                        </div>                            <div class="attributes">                                    &lt;optional&gt;                                                                </div>                                            </div>            </div>        <div class="details">                                                            </div>                                <h5>Returns:</h5>                    <div class="sub-content">        <span class="param-type">Object</span>    </div>                </div>                    <div class="item">                                <div class="item-type">function</div>                        <h4 class="name" id="getGuideline"><span class="type-signature"></span>getGuideline<span class="signature">()</span><span class="type-signature"> → {Element}</span></h4>                                            <div class="details">                                                            </div>                                <h5>Returns:</h5>                    <div class="sub-content">        <span class="param-type">Element</span>    </div>                </div>                    <div class="item">                                <div class="item-type">function</div>                        <h4 class="name" id="getName"><span class="type-signature"></span>getName<span class="signature">()</span><span class="type-signature"> → {string}</span></h4>                                            <div class="details">                                                            </div>                                <h5>Returns:</h5>                    <div class="sub-content">        <span class="param-type">string</span>    </div>                </div>                    <div class="item">                                <div class="item-type">function</div>                        <h4 class="name" id="hasMultiTableSupport"><span class="type-signature"></span>hasMultiTableSupport<span class="signature">()</span><span class="type-signature"> → {boolean}</span></h4>                            <div class="description">        Plugin can have multiple hosts/tables and share its states across those hosts/tables.    </div>                        <div class="details">                    <dt class="tag-overrides">Overrides:</dt>    <dd class="tag-overrides">        <a href="">GridPlugin#hasMultiTableSupport</a>    </dd>                                                </div>                                <h5>Returns:</h5>                    <div class="sub-content">        <span class="param-type">boolean</span>    </div>                </div>                    <div class="item">                                <div class="item-type">function</div>                        <h4 class="name" id="initialize"><span class="type-signature"></span>initialize<span class="signature">(host, options)</span><span class="type-signature"></span></h4>                                                <h5>Parameters:</h5>        <div class="params">        <div class="param">                            <div class="name">host</div>                        <div class="type">                            <span class="param-type">Object</span>                        </div>                                                    <div class="description">                    core grid instance                </div>                    </div>                <div class="param">                            <div class="name">options</div>                        <div class="type">                            <span class="param-type">Object</span>                        </div>                                            </div>            </div>        <div class="details">                                                            </div>                                    </div>                    <div class="item">                                <div class="item-type">function</div>                        <h4 class="name" id="isDisabled"><span class="type-signature"></span>isDisabled<span class="signature">()</span><span class="type-signature"> → {boolean}</span></h4>                                            <div class="details">                                                            </div>                                <h5>Returns:</h5>                    <div class="sub-content">        <span class="param-type">boolean</span>    </div>                </div>                    <div class="item">                                <div class="item-type">function</div>                        <h4 class="name" id="startDrag"><span class="type-signature"></span>startDrag<span class="signature">(startRef, opt_suppressEvent<span class="signature-attributes">opt</span>)</span><span class="type-signature"></span></h4>                                                <h5>Parameters:</h5>        <div class="params">        <div class="param">                            <div class="name">startRef</div>                        <div class="type">                            <span class="param-type">*</span>                        </div>                            <div class="attributes">                                                                </div>                                            </div>                <div class="param">                            <div class="name">opt_suppressEvent</div>                        <div class="type">                            <span class="param-type">boolean</span>                        </div>                            <div class="attributes">                                    &lt;optional&gt;                                                                </div>                                            </div>            </div>        <div class="details">                                                            </div>                                    </div>                    <div class="item">                                <div class="item-type">function</div>                        <h4 class="name" id="stopDrag"><span class="type-signature"></span>stopDrag<span class="signature">()</span><span class="type-signature"></span></h4>                                            <div class="details">                                                            </div>                                    </div>                    <div class="item">                                <div class="item-type">function</div>                        <h4 class="name" id="unload"><span class="type-signature"></span>unload<span class="signature">(host)</span><span class="type-signature"></span></h4>                                                <h5>Parameters:</h5>        <div class="params">        <div class="param">                            <div class="name">host</div>                        <div class="type">                            <span class="param-type">Object</span>                        </div>                                                    <div class="description">                    core grid instance                </div>                    </div>            </div>        <div class="details">                                                            </div>                                    </div>                        <h3 class="subsection-title" id="events">Events</h3>                    <div class="item">                                <div class="item-type">event</div>                        <h4 class="name" id="event:dataMoved">dataMoved</h4>                            <div class="description">        Fired when rows or data are moved by drag operation.    </div>                    <h5>Type:</h5>        <span class="param-type">Object</span>                <div class="details">                                                            </div>                                    </div>                    <div class="item">                                <div class="item-type">event</div>                        <h4 class="name" id="event:drag">drag</h4>                            <div class="description">        Fired on each mousemove or touchmove    </div>                    <h5>Type:</h5>        <span class="param-type">Object</span>                <div class="details">                                                            </div>                                    </div>                    <div class="item">                                <div class="item-type">event</div>                        <h4 class="name" id="event:dragEnd">dragEnd</h4>                            <div class="description">        The event will always be fired at the end of the drag operation. This is to allow clearing of any resource used. You can cancel the data moving operation by setting cancel property to true.    </div>                    <h5>Type:</h5>        <span class="param-type">Object</span>                <div class="details">                                                            </div>                                    </div>                    <div class="item">                                <div class="item-type">event</div>                        <h4 class="name" id="event:dragInterval">dragInterval</h4>                            <div class="description">        Fired at an interval during drag    </div>                    <h5>Type:</h5>        <span class="param-type">Object</span>                <div class="details">                                                            </div>                                    </div>                    <div class="item">                                <div class="item-type">event</div>                        <h4 class="name" id="event:dragStart">dragStart</h4>                            <div class="description">        The event is fired at the beginning of the drag operation. You can cancel the operation by setting cancel property to true.    </div>                    <h5>Type:</h5>        <span class="param-type">Object</span>                <div class="details">                                                            </div>                                            <h5>Example:</h5>            <pre><code>// ...
dragStart: function(e) {
  e.cancel = true; // To cancel the operation
}, // ..</code></pre>    </div>            </article></section></div></div>